<div>
  {{#each orderItems as |orderItem| }}
  <div style="background-color: #FF577F; margin: 2px">  
      
      <p>Product Name: {{orderItem.product.product_name}}</p>
      <p>Unit Price: £{{orderItem.product.price}}</p>
      <p>Quantity: {{orderItem.quantity}}</p>
      <p>Confirmed: {{orderItem.confirmed}}</p>
    
  </div>
  {{/each}}
  <p>Total value: £{{totalValue}}</p>
  <button id="enterDetailsBtn" onClick="checkoutFunc({{user_id}})">Checkout</button>
</div>

<script> 

  async function checkoutFunc(id) {

    try {

      const response_order = await fetch(`/api/orderItems/users/${id}`, {
        method: 'GET',
        headers: { 'Content-Type': 'application/json' }
      });

      const orderItem = await response_order.json();

      const response = await fetch('/create-checkout-session', {
        method: 'POST',
        body: JSON.stringify(orderItem),
        headers: { 'Content-Type': 'application/json' },
      })

      const { url } = await response.json();
      window.location = url;
    } catch (error) {
      console.error(error)
    }
    
  }
</script>

